<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <script src="js/jquery-2.1.3.min.js"></script>
    <link rel="stylesheet" href="css/index.css" />
    <title>ã˜ã‚ƒã‚“ã‘ã‚“</title>
  </head>

  <body>
    <main>
      <div class="score_display">
        <span class="score_label">ç‚¹æ•°:</span>
        <span id="current_score">0</span>
        <span class="score_unit">ç‚¹</span>
      </div>
      <h1>ã˜ã‚ƒã‚“ã‘ã‚“</h1>
      <section id="play">
       
          <div class="play_area">
            <div class="boy_wrap">
                <div class="name">ã‚ãªãŸ</div>
              <img id="boy_img" src="img_janken/boy_draw.png" alt="ã‚ãªãŸ">
              <img id="boy_hand_img" src="" alt="ã‚ãªãŸã®æ‰‹" />
              <div class="user_text">ã‚ãªãŸã¯ã€Œ<span id="user_hands">ãªã«ï¼Ÿ</span>ã€</div>
            
        </div>
        <div class="judgement_wrap">
            <div id="judgment" class="result"><span class="pon">ã½ã€€ã‚“</span></div>

            <div class="call">
                <p class="call_text">ã©ã‚Œã‹ãˆã‚‰ã‚“ã§ãƒœã‚¿ãƒ³ã‚’ãŠãã†ï¼</p>
              </div>
              <div id="btn">
                <div class="btn_area">
                    <img class="janken_btn" id="gu_btn" src="img_janken/gu.png" alt="ã‚°ãƒ¼">
                    <img class="janken_btn" id="cho_btn" src="img_janken/cyo.png" alt="ãƒãƒ§ã‚­">
                    <img class="janken_btn" id="par_btn" src="img_janken/par.png" alt="ãƒ‘ãƒ¼">
                  </div>
                  <div id="score_message" style="display: none;"></div>
              </div>
        </div>

        
            <div class="pc_wrap">
                <div class="name">ã¨ã‚‚ã ã¡</div>
              <img id="girl_img" src="img_janken/girl_draw.png" alt="ã¨ã‚‚ã ã¡">
              <img id="girl_hand_img" src="" alt="PCã®æ‰‹" />
              <div class="pc_text">ã¨ã‚‚ã ã¡ã¯ã€Œ<span id="pc_hands">ãªã«ï¼Ÿ</span>ã€</div>
          
        </div>
        </div>
        </div>
      </section>

      <!-- ãƒ«ãƒ¼ãƒ«èª¬æ˜ã‚¨ãƒªã‚¢ -->
      <section id="rules" style="display: none;">
        <div class="rules_container">
          <div class="boy_rules">
            <h3>ã˜ã‚ƒã‚“ã‘ã‚“ã£ã¦ï¼Ÿ</h3>
            <div class="rule_item">
              <img src="img_janken/gu.png" alt="ã‚°ãƒ¼" class="hand_icon">
              <span class="equals">=</span>
              <span class="stone">ğŸª¨ ã„ã—</span>
            </div>
            <div class="rule_item">
              <img src="img_janken/cyo.png" alt="ãƒãƒ§ã‚­" class="hand_icon">
              <span class="equals">=</span>
              <span class="scissors">âœ‚ï¸ ã¯ã•ã¿</span>
            </div>
            <div class="rule_item">
              <img src="img_janken/par.png" alt="ãƒ‘ãƒ¼" class="hand_icon">
              <span class="equals">=</span>
              <span class="paper">ğŸ“„ ã‹ã¿</span>
            </div>
          </div>

          <div class="girl_rules">
            <h3>ã©ã£ã¡ãŒã‹ã¤ã®ï¼Ÿ</h3>
            <div class="win_rule">
              <span class="stone">ğŸª¨ ã„ã—</span>
              <span class="beats">ã¯</span>
              <span class="scissors">âœ‚ï¸ ã¯ã•ã¿</span>
              <span class="reason">ã‚’ã“ã‚ã™</span>
            </div>
            <div class="win_rule">
              <span class="scissors">âœ‚ï¸ ã¯ã•ã¿</span>
              <span class="beats">ã¯</span>
              <span class="paper">ğŸ“„ ã‹ã¿</span>
              <span class="reason">ã‚’ãã‚‹</span>
            </div>
            <div class="win_rule">
              <span class="paper">ğŸ“„ ã‹ã¿</span>
              <span class="beats">ã¯</span>
              <span class="stone">ğŸª¨ ã„ã—</span>
              <span class="reason">ã‚’ã¤ã¤ã‚€</span>
            </div>
          </div>
        </div>
      </section>

    <div class="return_btn">
        <button onclick="location.href='index.html'" class="return_button">ã‚‚ã©ã‚‹</button>
    </div>

    <div class="help_btn">
        <button id="help_button" class="help_button">ã‚ãã³ã‹ãŸ</button>
    </div>
    </main>
    <script>
      // ç‚¹æ•°ç®¡ç†å¤‰æ•°
      let score = 0;

      // ç‚¹æ•°ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰èª­ã¿è¾¼ã¿
      function loadScore() {
        const savedScore = localStorage.getItem('janken_score');
        score = savedScore ? parseInt(savedScore) : 0;
        updateScoreDisplay();
      }

      // ç‚¹æ•°ã‚’ä¿å­˜
      function saveScore() {
        localStorage.setItem('janken_score', score.toString());
      }

      // ç‚¹æ•°è¡¨ç¤ºã‚’æ›´æ–°
      function updateScoreDisplay() {
        $('#current_score').text(score);
      }

      // ç‚¹æ•°ã‚’åŠ ç®—
      function addScore(points) {
        score += points;
        updateScoreDisplay();
        saveScore();
      }

      // ã‚ãã³ã‹ãŸãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
      $(document).ready(function() {
        loadScore();
        
        // ã‚ãã³ã‹ãŸãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯å‡¦ç†
        $('#help_button').on('click', function() {
          const $rules = $('#rules');
          const $button = $(this);
          
          if ($rules.is(':visible')) {
            $rules.slideUp(300);
            $button.text('ã‚ãã³ã‹ãŸ');
          } else {
            $rules.slideDown(300);
            $button.text('ã¨ã˜ã‚‹');
          }
        });
      });

      $("#gu_btn, #cho_btn, #par_btn").on("click", function () {
        //ï¼‘ã€‚ã‚°ãƒ¼ãƒ»ãƒãƒ§ã‚­ãƒ¼ãƒ»ãƒ‘ãƒ¼ã‚’ã€Œãªã«ï¼Ÿã€ã«è¡¨ç¤ºã•ã›ã‚‹
        const r = Math.ceil(Math.random() * 3);
        let pc_hands = "";
        if (r === 1) {
          pc_hands = "ã‚°ãƒ¼";
          hand_img = "img_janken/gu.png";
        }
        if (r === 2) {
          pc_hands = "ãƒãƒ§ã‚­";
          hand_img = "img_janken/cyo.png";
        }
        if (r === 3) {
          pc_hands = "ãƒ‘ãƒ¼";
          hand_img = "img_janken/par.png";
        }

        $("#pc_hands").html(pc_hands);
        $("#girl_hand_img").attr("src", hand_img).show();

        //ï¼’ã€‚ã‚ãªãŸãŒä½•ã‚’å‡ºã—ãŸã‹ã‚’ã€Œãªã«ï¼Ÿã€ã«è¡¨ç¤ºã•ã›ã‚‹ã€‚
        const u = $(this).attr("id");
        let user_hands = "";

        if (u === "gu_btn") {
          user_hands = "ã‚°ãƒ¼";
          hand_img = "img_janken/gu.png";
        }
        if (u === "cho_btn") {
          user_hands = "ãƒãƒ§ã‚­";
          hand_img = "img_janken/cyo.png";
        }
        if (u === "par_btn") {
          user_hands = "ãƒ‘ãƒ¼";
          hand_img = "img_janken/par.png";
        }

        $("#user_hands").html(user_hands);
        $("#boy_hand_img").attr("src", hand_img).show();

        //ï¼“ã€‚åˆ¤å®š
        // ã‚¹ã‚³ã‚¢ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’éš ã™
        $("#score_message").hide();
        
        if (user_hands === pc_hands) {
          $("#judgment").html("ã‚ã„ã“");
          $("#boy_img").attr("src", "img_janken/boy_draw.png");
          $("#girl_img").attr("src", "img_janken/girl_draw.png");

        } else if (user_hands === "ã‚°ãƒ¼" && pc_hands === "ãƒãƒ§ã‚­") {
          $("#judgment").html("ã‚ãªãŸã®<br>ã‹ã¡");
          $("#boy_img").attr("src", "img_janken/boy_win.png");
          $("#girl_img").attr("src", "img_janken/girl_lose.png");
          $("#score_message").html("<span class='score_get'>1ã¦ã‚“ã‚²ãƒƒãƒˆï¼</span>").show();
          addScore(1);

        } else if (user_hands === "ã‚°ãƒ¼" && pc_hands === "ãƒ‘ãƒ¼") {
          $("#judgment").html("ã‚ãªãŸã®<br>ã¾ã‘");
          $("#boy_img").attr("src", "img_janken/boy_lose.png");
          $("#girl_img").attr("src", "img_janken/girl_win.png");

        } else if (user_hands === "ãƒãƒ§ã‚­" && pc_hands === "ãƒ‘ãƒ¼") {
          $("#judgment").html("ã‚ãªãŸã®<br>ã‹ã¡");
          $("#boy_img").attr("src", "img_janken/boy_win.png");
          $("#girl_img").attr("src", "img_janken/girl_lose.png");
          $("#score_message").html("<span class='score_get'>1ã¦ã‚“ã‚²ãƒƒãƒˆï¼</span>").show();
          addScore(1);

        } else if (user_hands === "ãƒãƒ§ã‚­" && pc_hands === "ã‚°ãƒ¼") {
          $("#judgment").html("ã‚ãªãŸã®<br>ã¾ã‘");
          $("#boy_img").attr("src", "img_janken/boy_lose.png");
          $("#girl_img").attr("src", "img_janken/girl_win.png");

        } else if (user_hands === "ãƒ‘ãƒ¼" && pc_hands === "ã‚°ãƒ¼") {
          $("#judgment").html("ã‚ãªãŸã®<br>ã‹ã¡");
          $("#boy_img").attr("src", "img_janken/boy_win.png");
          $("#girl_img").attr("src", "img_janken/girl_lose.png");
          $("#score_message").html("<span class='score_get'>1ã¦ã‚“ã‚²ãƒƒãƒˆï¼</span>").show();
          addScore(1);

        } else if (user_hands === "ãƒ‘ãƒ¼" && pc_hands === "ãƒãƒ§ã‚­") {
          $("#judgment").html("ã‚ãªãŸã®<br>ã¾ã‘");
          $("#boy_img").attr("src", "img_janken/boy_lose.png");
          $("#girl_img").attr("src", "img_janken/girl_win.png");

        } else {
          $("#judgment").html("");
        }
      });
    </script>
  </body>
</html>
